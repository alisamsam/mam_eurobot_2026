# ---------------------------------------------------------
# 1. Build + launch
# ---------------------------------------------------------
colcon build --symlink-install
source install/setup.bash
ros2 launch mam_eurobot_2026 arena.launch.py
ros2 launch mam_eurobot_2026 combined.launch.py
ros2 launch mam_eurobot_2026 arena.launch.py launch_rviz:=true


# ---------------------------------------------------------
# 2. Gazebo model management
# ---------------------------------------------------------
ign model --remove simple_robot
ign service -s /world/eurobot_2026_arena/create \
  --reqtype ignition.msgs.EntityFactory \
  --reptype ignition.msgs.Boolean \
  --timeout 300 \
  --req 'sdf_filename:"/workspaces/mam_eurobot_2026/models/simple_robot", name:"model"'

ros2 run ros_gz_sim create \
  -file /workspaces/mam_eurobot_2026/models/simple_robot/model.sdf \
  -name simple_robot -x 0 -y 0 -z 0.05

ign service -s /world/eurobot_2026_arena/remove \
  --reqtype ignition.msgs.Entity \
  --reptype ignition.msgs.Boolean \
  --timeout 300 \
  --req 'name:"simple_robot", type:MODEL'

# Crates
ign service -s /world/eurobot_2026_arena/remove \
  --reqtype ignition.msgs.Entity \
  --reptype ignition.msgs.Boolean \
  --timeout 300 \
  --req 'name:"crate", type:MODEL'

ros2 run ros_gz_sim create \
  -file /workspaces/mam_eurobot_2026/models/crate/model.sdf \
  -name crate -x 0.3 -y 0.3 -z 0.05

ros2 run ros_gz_sim create \
  -file /workspaces/mam_eurobot_2026/models/crate/crate_aruco.sdf \
  -name crate2 -x 0.4 -y 0.3 -z 0.05

# ---------------------------------------------------------
# 3. Bridges utiles (cam√©ra, lidar, TF, etc.)
# ---------------------------------------------------------
ros2 run ros_gz_bridge parameter_bridge \
  /camera/image_raw@sensor_msgs/msg/Image@gz.msgs.Image

ros2 run ros_gz_bridge parameter_bridge \
  /lidar@sensor_msgs/msg/LaserScan[ignition.msgs.LaserScan \
  /model/simple_robot/tf@tf2_msgs/msg/TFMessage[ignition.msgs.Pose_V \
  --ros-args -r /lidar:=/scan

ros2 run ros_gz_bridge parameter_bridge \
  /model/simple_robot/pose@tf2_msgs/msg/TFMessage[ignition.msgs.Pose_V

# ---------------------------------------------------------
# 4. Notes
# ---------------------------------------------------------
# ROS spawn objects at their center of mass:
# (+Y) <--- X ---> (-Y)
#  ^                   v
# +X                 -X
#
# Rotation order: -R (roll), -P (pitch), -Y (yaw)
#
# RViz parfois : rm -rf ~/.rviz2
